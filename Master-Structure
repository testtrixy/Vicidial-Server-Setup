vicidial-installer/
â”œâ”€â”€ install.sh                  # ðŸ”¥ MAIN ORCHESTRATOR (entrypoint)
â”œâ”€â”€ README.md                   # High-level usage & phases
â”œâ”€â”€ VERSION

â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ installer.conf          # Global non-secret config (timezone, domain, versions)
â”‚   â”œâ”€â”€ secrets.env             # ðŸ”’ Passwords, AMI secrets, DB creds (gitignored)
â”‚   â””â”€â”€ versions.conf           # Asterisk, DAHDI, LibPRI versions

â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ common.sh               # Logging, colors, run_stage(), fatal()
â”‚   â”œâ”€â”€ os.sh                   # OS detection & validation
â”‚   â”œâ”€â”€ render.sh               # Template rendering (envsubst / sed)
â”‚   â””â”€â”€ guards.sh               # Idempotency markers, safety checks

â”œâ”€â”€ stages/
â”‚   â”œâ”€â”€ 00-preflight/
â”‚   â”‚   â”œâ”€â”€ 00-check-root.sh
â”‚   â”‚   â”œâ”€â”€ 01-check-os.sh
â”‚   â”‚   â””â”€â”€ 02-disable-selinux.sh
â”‚
â”‚   â”œâ”€â”€ 01-os/
â”‚   â”‚   â”œâ”€â”€ 00-rocky9-base.sh
â”‚   â”‚   â”œâ”€â”€ 01-repos.sh
â”‚   â”‚   â”œâ”€â”€ 02-firewall.sh
â”‚   â”‚   â””â”€â”€ 03-timezone.sh
â”‚
â”‚   â”œâ”€â”€ 02-web-db/
â”‚   â”‚   â”œâ”€â”€ 01-install-apache.sh
â”‚   â”‚   â”œâ”€â”€ 02-install-php74.sh
â”‚   â”‚   â”œâ”€â”€ 03-install-mariadb.sh
â”‚   â”‚   â””â”€â”€ 04-mariadb-tuning.sh
â”‚
â”‚   â”œâ”€â”€ 03-build-tools/
â”‚   â”‚   â”œâ”€â”€ 01-devtools.sh
â”‚   â”‚   â”œâ”€â”€ 02-perl-modules.sh
â”‚   â”‚   â””â”€â”€ 03-missing-libs.sh
â”‚
â”‚   â”œâ”€â”€ 04-telephony/
â”‚   â”‚   â”œâ”€â”€ 01-install-dahdi.sh
â”‚   â”‚   â”œâ”€â”€ 02-install-libpri.sh
â”‚   â”‚   â”œâ”€â”€ 03-install-jansson-srtp.sh
â”‚   â”‚   â”œâ”€â”€ 04-download-asterisk.sh
â”‚   â”‚   â”œâ”€â”€ 05-apply-vicidial-patches.sh
â”‚   â”‚   â”œâ”€â”€ 06-build-asterisk.sh
â”‚   â”‚   â””â”€â”€ 07-install-asterisk.sh
â”‚
â”‚   â”œâ”€â”€ 05-asterisk-config/
â”‚   â”‚   â”œâ”€â”€ 01-modules-conf.sh
â”‚   â”‚   â”œâ”€â”€ 02-ami-conf.sh
â”‚   â”‚   â”œâ”€â”€ 03-ami-harden.sh
â”‚   â”‚   â””â”€â”€ 04-sip-core.sh
â”‚
â”‚   â”œâ”€â”€ 06-vicidial/
â”‚   â”‚   â”œâ”€â”€ 01-install-astguiclient.sh
â”‚   â”‚   â”œâ”€â”€ 02-db-bootstrap.sh
â”‚   â”‚   â”œâ”€â”€ 03-run-install-pl.sh
â”‚   â”‚   â”œâ”€â”€ 04-permissions.sh
â”‚   â”‚   â””â”€â”€ 05-cron-install.sh
â”‚
â”‚   â”œâ”€â”€ 07-extras/
â”‚   â”‚   â”œâ”€â”€ 01-certbot.sh
â”‚   â”‚   â”œâ”€â”€ 02-cyburphone.sh
â”‚   â”‚   â””â”€â”€ 03-dynportal.sh
â”‚
â”‚   â””â”€â”€ 99-post/
â”‚       â”œâ”€â”€ 01-healthcheck.sh
â”‚       â”œâ”€â”€ 02-summary.sh
â”‚       â””â”€â”€ 03-reboot-hint.sh
â”‚
â”œâ”€â”€ templates/
â”‚   â”œâ”€â”€ asterisk/
â”‚   â”‚   â”œâ”€â”€ modules.conf.tpl
â”‚   â”‚   â”œâ”€â”€ manager.conf.tpl
â”‚   â”‚   â”œâ”€â”€ sip.conf.tpl
â”‚   â”‚   â””â”€â”€ pjsip.conf.tpl
â”‚   â”‚
â”‚   â”œâ”€â”€ apache/
â”‚   â”‚   â””â”€â”€ vicidial.conf.tpl
â”‚   â”‚
â”‚   â””â”€â”€ mariadb/
â”‚       â””â”€â”€ my.cnf.tpl
â”‚
â”œâ”€â”€ sql/
â”‚   â”œâ”€â”€ asterisk/
â”‚   â”‚   â”œâ”€â”€ MySQL_AST_CREATE_tables.sql
â”‚   â”‚   â”œâ”€â”€ MySQL_AST_CREATE_tables-vicidial.sql
â”‚   â”‚   â””â”€â”€ MySQL_AST_CREATE_queues.sql
â”‚   â”‚
â”‚   â””â”€â”€ vicidial/
â”‚       â””â”€â”€ initial-data.sql
â”‚
â”œâ”€â”€ tools/
â”‚   â”œâ”€â”€ patch-audit.sh          # Verifies Vicidial patches applied
â”‚   â”œâ”€â”€ ami-test.sh             # Tests AMI login
â”‚   â””â”€â”€ dialplan-dump.sh
â”‚
â”œâ”€â”€ health/
â”‚   â”œâ”€â”€ healthcheck.sh
â”‚   â””â”€â”€ checks/
â”‚       â”œâ”€â”€ 01-os.sh
â”‚       â”œâ”€â”€ 02-packages.sh
â”‚       â”œâ”€â”€ 03-asterisk.sh
â”‚       â”œâ”€â”€ 04-ami.sh
â”‚       â”œâ”€â”€ 05-db.sh
â”‚       â”œâ”€â”€ 06-astguiclient.sh
â”‚       â”œâ”€â”€ 07-cron.sh
â”‚       â””â”€â”€ 08-dialer.sh
â”‚
â””â”€â”€ .gitignore
